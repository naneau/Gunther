((function(){var a,b,c,d,e,f,g,h,i=Object.prototype.hasOwnProperty,j=function(a,b){function d(){this.constructor=a}for(var c in b)i.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},k=Array.prototype.slice;b={},typeof require!=null?module.exports=b:window.Gunther=b,b.IDGenerator=function(){function a(){this.value=0}return a.prototype.generate=function(){return this.value++},a}(),b.HTML=function(){function a(){}return a.elements=["a","abbr","address","article","aside","audio","b","bdi","bdo","blockquote","body","button","canvas","caption","cite","code","colgroup","datalist","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","html","i","iframe","ins","kbd","label","legend","li","map","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","video","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","applet","acronym","bgsound","dir","frameset","noframes","isindex","listing","nextid","noembed","plaintext","rb","strike","xmp","big","blink","center","font","marquee","multicol","nobr","spacer","tt","basefont","frame","date"],a.eventNames=["load","unload","blur","change","focus","reset","select","submit","abort","keydown","keyup","keypress","click","dblclick","mousedown","mouseout","mouseover","mouseup"],a}(),a=function(){function a(a,b,c){var d,e,f,g,h=this;this.model=a,this.propertyNames=b,this.valueGenerator=c,this.valueGenerator==null&&typeof this.propertyNames=="string"&&(this.valueGenerator=function(){return h.model.get(h.propertyNames[0])}),this.propertyNames=[].concat(this.propertyNames),g=this.propertyNames;for(e=0,f=g.length;e<f;e++)d=g[e],this.model.bind("change:"+d,function(){return h.trigger("change",h.getValue())})}return a.prototype.getValue=function(){var a;return a=this.valueGenerator(),a instanceof b.Template?a.render():a},a}(),_.extend(a.prototype,Backbone.Events),c=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return j(c,a),c.generator=new b.IDGenerator,c.prototype.initialize=function(a){var b=this;return this.key="_subview-"+c.generator.generate(),this.elementKey="element-"+this.key,this.prepend=a.prepend!=null?a.prepend:!1,this.generator=a.generator,this.model.each(function(a){return b.initItem(a)}),this.model.bind("add",function(a){return b.initItem(a),b.renderItem(a)}),this.model.bind("remove",function(a){if(a[b.key]==null)return;return a[b.key]instanceof Backbone.View?a[b.key].remove():a[b.elementKey].remove()})},c.prototype.initItem=function(a){return a[this.key]=this.generator(a)},c.prototype.renderItem=function(a){if(a[this.key]instanceof b.Template)a[this.elementKey]=a[this.key].render(a);else{if(!(a[this.key]instanceof Backbone.View))throw new Error("Generator must return either a Gunther.Template or a Backbone.View instance");a[this.key].render(),a[this.elementKey]=a[this.key].el}return this.prepend?this.el.prepend(a[this.elementKey]):this.el.append(a[this.elementKey])},c.prototype.render=function(){var a=this;return this.model.each(function(b){return a.renderItem(b)})},c}(Backbone.View),b.Template=function(){function d(a){this.fn=a,null}return d.domParsers=[],d.createHtmlElement=function(a){return $(document.createElement(a))},d.addAttributes=function(c,d){var e,f,g,h,i,j;j=[];for(h=0,i=d.length;h<i;h++)e=d[h],j.push(function(){var d;d=[];for(f in e)g=e[f],d.push(function(d,e){return _.include(b.HTML.eventNames,d)?c.bind(d,function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],e.apply(null,a)}):e instanceof a?(c.attr(d,e.getValue()),e.bind("change",function(a){return c.attr(d,a)})):c.attr(d,e)}(f,g));return d}());return j},d.generateChildren=function(b,c,d){var e;e=c.apply(d),typeof e!="object"&&b.append(document.createTextNode(e));if(e instanceof a)return b.html(e.getValue()),e.bind("change",function(a){return b.html(a)});if(e instanceof Backbone.View)return e.el=b,e.render()},d.prototype.render=function(){var a,c,d,e,f,g,h,i,j;a=1<=arguments.length?k.call(arguments,0):[],this.root=$("<div />"),this.current=this.root,this.fn.apply(this,a),d=this.root.children(),j=b.Template.domParsers;for(f=0,h=j.length;f<h;f++){e=j[f];for(g=0,i=d.length;g<i;g++)c=d[g],e(c)}return d},d.prototype.renderInto=function(){var a,b,c,d,e,f;c=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],f=this.render.apply(this,a);for(d=0,e=f.length;d<e;d++)b=f[d],c.append(b);return new Backbone.View({el:c})},d.prototype.text=function(b){var c,d;return d=document.createTextNode(""),typeof b=="string"?d.nodeValue=b:(typeof b=="function"&&(c=b.apply(this)),c instanceof a&&(d.nodeValue=c.getValue(),c.bind("change",function(a){return d.nodeValue=a}))),this.current.append(d)},d.prototype.addElement=function(){var a,c,d,e;return e=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],c=this.current,d=b.Template.createHtmlElement(e),this.current=d,typeof a[a.length-1]=="function"&&b.Template.generateChildren(d,a.pop(),this),b.Template.addAttributes(d,a),c.append(d),this.current=c,null},d.prototype.bind=function(){var b;return b=1<=arguments.length?k.call(arguments,0):[],function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return typeof e=="object"?e:d}(a,b,function(){})},d.prototype.itemSubView=function(a){return new c(a)},d.prototype.e=function(){var a,b;return b=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],this.addElement.apply(this,[b].concat(k.call(a)))},d.prototype.t=function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],this.text.apply(this,a)},d}(),h=b.HTML.elements,e=function(a){return b.Template.prototype[a]=function(){var b;return b=1<=arguments.length?k.call(arguments,0):[],this.addElement.apply(this,[a].concat(k.call(b)))}};for(f=0,g=h.length;f<g;f++)d=h[f],e(d)})).call(this);